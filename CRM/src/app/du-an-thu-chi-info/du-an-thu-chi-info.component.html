<div class="app-hero-header d-flex align-items-center" style="margin-top: 0px;">
    <div class="d-flex align-items-center">
        <div class="me-3 icon-box md bg-white rounded-4">
            <i class="bi bi-bank2 fs-3 text-primary"></i>
        </div>
        <div>
            <h5 class="mb-1" style="font-size: 12px;">
                Dự án: <a routerLink="/DuAnInfo/{{DuAnService.FormData.ID}}" class="link-primary"><b>{{DuAnService.FormData.Name}}
                    [{{DuAnService.FormData.ID}}]</b></a>
                / Quyết định: <a
                    routerLink="/DuAnQuyetDinhInfo/{{DuAnService.FormData.ID}}/{{DuAnQuyetDinhService.FormData.ID}}" class="link-primary"><b>{{DuAnQuyetDinhService.FormData.SoQuyetDinh}}
                    [{{DuAnQuyetDinhService.FormData.ID}}]</b></a>
                / Thu chi: <a
                    routerLink="/DuAnThuChiInfo/{{DuAnService.FormData.ID}}/{{DuAnQuyetDinhService.FormData.ID}}/{{DuAnThuChiService.FormData.ID}}" class="link-primary"><b>{{DuAnThuChiService.FormData.Name}}
                    [{{DuAnThuChiService.FormData.ID}}]</b></a>
            </h5>
            <h6 class="m-0 text-dark fw-light">
                <a routerLink="/DuAn001" class="link-primary">
                    <b>Dự án</b>
                </a>
            </h6>
        </div>
    </div>
</div>
<div class="app-body">
    <div class="row">
        <div class="col-xxl-12">
            <div class="card" style="margin-left: 1px;">
                <div class="card-body">
                    <div class="custom-tabs-container">
                        <ul class="nav nav-tabs justify-content-end" id="customTab5" role="tablist">
                            <li class="nav-item" role="presentation">
                                <a class="nav-link active" id="tab-DuAnThuChiDetail" data-bs-toggle="tab" href="#DuAnThuChiDetail"
                                    role="tab" aria-controls="DuAnThuChiDetail" aria-selected="true">
                                    <span class="badge bg-info" style="font-size: 12px;">Thu chi</span>
                                </a>
                            </li>
                            <li class="nav-item" role="presentation">
                                <a class="nav-link" id="tab-DuAnThuChiTapTinDinhKem" data-bs-toggle="tab"
                                    href="#DuAnThuChiTapTinDinhKem" role="tab" aria-controls="DuAnThuChiTapTinDinhKem"
                                    aria-selected="true">
                                    <span class="badge bg-primary" style="font-size: 12px;">Đính kèm</span>
                                </a>
                            </li>                           
                        </ul>
                        <div class="tab-content" id="customTabContent">
                            <div class="tab-pane fade show active" id="DuAnThuChiDetail" role="tabpanel">
                                <div class="row gx-4">
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <a style="width: 100%;" title="Quay lại danh sách" (click)="DuAnThuChiIsBack()" class="btn btn-success"><i
                                                class="bi bi-arrow-90deg-left"></i> Quay lại danh sách</a>
                                    </div>
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <a style="width: 100%;" title="Lưu thay đổi" (click)="DuAnThuChiSave()" class="btn btn-info" *ngIf="IsDuAnThuChiSave"><i
                                                class="bi bi-sd-card"></i> Lưu thay đổi</a>
                                    </div>
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <div class="form-check form-check-inline mb-6">
                                            <input type="checkbox" class="form-check-input" name="Active"
                                                [(ngModel)]="DuAnThuChiService.FormData.Active" />
                                            <label class="form-check-label" for="Active">Đã quyết toán (Khoá)</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row gx-4">
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Biểu mẫu
                                                [{{DuAnThuChiService.FormData.DanhMucBieuMauID}}]</label>
                                            <select class="form-select" name="DanhMucBieuMauID"
                                                [(ngModel)]="DuAnThuChiService.FormData.DanhMucBieuMauID">
                                                <option *ngFor="let item of DanhMucBieuMauService.List;" [value]="item.ID">
                                                    {{item.Name}} [{{item.ID}}]</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Hình thức
                                                [{{DuAnThuChiService.FormData.DanhMucHinhThucThanhToanID}}]</label>
                                            <select class="form-select" name="DanhMucHinhThucThanhToanID"
                                                [(ngModel)]="DuAnThuChiService.FormData.DanhMucHinhThucThanhToanID">
                                                <option *ngFor="let item of DanhMucHinhThucThanhToanService.List;" [value]="item.ID">
                                                    {{item.Name}} [{{item.ID}}]</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Quyết định
                                                [{{DuAnThuChiService.FormData.DuAnQuyetDinhID}}]</label>
                                            <select class="form-select" name="DuAnQuyetDinhID"
                                                [(ngModel)]="DuAnThuChiService.FormData.DuAnQuyetDinhID" (change)="DuAnQuyetDinhChange($event)">
                                                <option [value]="0">
                                                    Chưa xác định</option>
                                                <option *ngFor="let item of DuAnQuyetDinhService.List;" [value]="item.ID">
                                                    {{item.SoQuyetDinh}} - {{item.Name}} [{{item.ID}}]</option>
                                            </select>
                                        </div>                                                              
                                    </div>
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Tiêu đề</label>
                                            <input name="Name" [(ngModel)]="DuAnThuChiService.FormData.Name" placeholder="Tiêu đề"
                                                type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Số chứng từ</label>
                                            <input name="SoChungTu" [(ngModel)]="DuAnThuChiService.FormData.SoChungTu"
                                                placeholder="Số hồ sơ" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Số bút toán</label>
                                            <input name="SoButToan" [(ngModel)]="DuAnThuChiService.FormData.SoButToan"
                                                placeholder="Số bút toán" type="text" class="form-control">
                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Ngày ghi nhận</label>
                                            <input [ngModel]="DuAnThuChiService.FormData.NgayGhiNhan | date:'yyyy-MM-dd'"
                                                style="text-align: right;" (ngModelChange)="DateNgayGhiNhan($event)"
                                                [ngModelOptions]="{ updateOn: 'blur' }" type="date" class="form-control" autocomplete="off">
                                        </div>       
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Số tiền ({{DuAnThuChiService.FormData.DonGia |
                                                number:
                                                '1.0-0'}})</label>
                                            <input name="DonGia" [(ngModel)]="DuAnThuChiService.FormData.DonGia" placeholder="Số tiền"
                                                type="number" class="form-control" style="text-align: right;">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Ghi chú</label>
                                            <input name="Note" [(ngModel)]="DuAnThuChiService.FormData.Note" placeholder="Ghi chú"
                                                type="text" class="form-control">
                                        </div>
                                    </div>
                                    <!-- <div class="col-lg-4 col-sm-12 col-12">
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Bên A (Bên duyệt)
                                                [{{DuAnThuChiService.FormData.BenDauTuID}}]</label>
                                            <select class="form-select" name="BenDauTuID"
                                                [(ngModel)]="DuAnThuChiService.FormData.BenDauTuID" (change)="BenDauTuSearch()">
                                                <option *ngFor="let item of ToChucService.List;" [value]="item.ID">
                                                    {{item.Display}} - {{item.Name}} [{{item.ID}}]</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Bên A (Bên duyệt)</label>
                                            <input name="BenDauTuName" [(ngModel)]="DuAnThuChiService.FormData.BenDauTuName"
                                                placeholder="Bên A (Bên duyệt)" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Đại diện bên A [{{DuAnThuChiService.FormData.NguoiDauTuID}}]</label>
                                            <mat-select class="form-control" name="DuAnThuChiService.FormData.NguoiDauTuID"
                                                (selectionChange)="NguoiDauTuSearch()"
                                                [(ngModel)]="DuAnThuChiService.FormData.NguoiDauTuID">
                                                <input placeholder="Tìm..." class="form-control"
                                                    (keyup)="ThanhVienFilter($event.target.value)">
                                                <mat-option *ngFor="let item of ThanhVienService.ListFilter" [value]="item.ID">
                                                    {{item.Name}} - {{item.TaiKhoan}}
                                                </mat-option>
                                            </mat-select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Đại diện bên A (người ký)</label>
                                            <input name="NguoiDauTuName" [(ngModel)]="DuAnThuChiService.FormData.NguoiDauTuName"
                                                placeholder="Đại diện bên A" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Chức danh</label>
                                            <input name="NguoiDauTuChucDanh" [(ngModel)]="DuAnThuChiService.FormData.NguoiDauTuChucDanh"
                                                placeholder="Chức danh" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Tài khoản bên A
                                                [{{DuAnThuChiService.FormData.BenDauTuTaiKhoanID}}]</label>
                                            <select class="form-select" name="BenDauTuTaiKhoanID"
                                                [(ngModel)]="DuAnThuChiService.FormData.BenDauTuTaiKhoanID"
                                                (change)="BenDauTuTaiKhoanSearch()">
                                                <option [value]="0">
                                                    Chưa xác định</option>
                                                <option *ngFor="let item of ToChucTaiKhoanService.ListFilter001;" [value]="item.ID">
                                                    {{item.Display}} - {{item.Description}} [{{item.ID}}]</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Tài khoản bên A</label>
                                            <input name="BenDauTuSoTaiKhoan" [(ngModel)]="DuAnThuChiService.FormData.BenDauTuSoTaiKhoan"
                                                placeholder="Tài khoản bên A" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Nguồn bên A</label>
                                            <input name="BenDauTuNganHang" [(ngModel)]="DuAnThuChiService.FormData.BenDauTuNganHang"
                                                placeholder="Nguồn bên A" type="text" class="form-control">
                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-sm-12 col-12">
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Bên B (Bên thực hiện)
                                                [{{DuAnThuChiService.FormData.BenThucHienID}}]</label>
                                            <select class="form-select" name="BenThucHienID"
                                                [(ngModel)]="DuAnThuChiService.FormData.BenThucHienID" (change)="BenThucHienSearch()">
                                                <option *ngFor="let item of ToChucService.List;" [value]="item.ID">
                                                    {{item.Display}} - {{item.Name}} [{{item.ID}}]</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Bên B (Bên thực hiện)</label>
                                            <input name="BenThucHienName" [(ngModel)]="DuAnThuChiService.FormData.BenThucHienName"
                                                placeholder="Bên B (Bên thực hiện)" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Đại diện bên B
                                                [{{DuAnThuChiService.FormData.NguoiThucHienID}}]</label>
                                            <mat-select class="form-control" name="DuAnThuChiService.FormData.NguoiThucHienID"
                                                (selectionChange)="NguoiThucHienSearch()"
                                                [(ngModel)]="DuAnThuChiService.FormData.NguoiThucHienID">
                                                <input placeholder="Tìm..." class="form-control"
                                                    (keyup)="ThanhVienFilter001($event.target.value)">
                                                <mat-option *ngFor="let item of ThanhVienService.ListFilter001" [value]="item.ID">
                                                    {{item.Name}} - {{item.TaiKhoan}}
                                                </mat-option>
                                            </mat-select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Đại diện bên B</label>
                                            <input name="NguoiThucHienName" [(ngModel)]="DuAnThuChiService.FormData.NguoiThucHienName"
                                                placeholder="Đại diện bên B" type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Chức danh</label>
                                            <input name="NguoiThucHienChucDanh"
                                                [(ngModel)]="DuAnThuChiService.FormData.NguoiThucHienChucDanh" placeholder="Chức danh"
                                                type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Tài khoản bên B
                                                [{{DuAnThuChiService.FormData.BenThucHienTaiKhoanID}}]</label>
                                            <select class="form-select" name="BenThucHienTaiKhoanID"
                                                [(ngModel)]="DuAnThuChiService.FormData.BenThucHienTaiKhoanID"
                                                (change)="BenThucHienTaiKhoanSearch()">
                                                <option [value]="0">
                                                    Chưa xác định</option>
                                                <option *ngFor="let item of ToChucTaiKhoanService.ListFilter002;" [value]="item.ID">
                                                    {{item.Display}} - {{item.Description}} [{{item.ID}}]</option>
                                            </select>
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Tài khoản bên B</label>
                                            <input name="BenThucHienSoTaiKhoan"
                                                [(ngModel)]="DuAnThuChiService.FormData.BenThucHienSoTaiKhoan" placeholder="Tài khoản bên B"
                                                type="text" class="form-control">
                                        </div>
                                        <div class="col-lg-12 col-sm-12 col-12">
                                            <label class="form-label">Nguồn bên B</label>
                                            <input name="BenThucHienNganHang" [(ngModel)]="DuAnThuChiService.FormData.BenThucHienNganHang"
                                                placeholder="Nguồn bên B" type="text" class="form-control">
                                        </div>
                                    </div> -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="DuAnThuChiTapTinDinhKem" role="tabpanel">
                                <div class="row gx-4">
                                    <div class="col-lg-11 col-sm-12 col-12">
                                        <input [(ngModel)]="DuAnTapTinDinhKemService.BaseParameter.SearchString" placeholder="Tìm ..."
                                            class="form-control" (keyup.enter)="DuAnTapTinDinhKemSearch()">
                                    </div>
                                    <div class="col-lg-1 col-sm-12 col-12">
                                        <a style="width: 100%;" class="btn btn-success" title="Tìm" (click)="DuAnTapTinDinhKemSearch()"><i
                                                class="bi bi-search"></i></a>&nbsp;&nbsp;&nbsp;
                                    </div>
                                </div>
                                <div class="card mb-4 card-primary">
                                    <div class="card-header">
                                        <h5 class="card-title text-white bg-primary">Danh sách
                                            <span *ngIf="DuAnTapTinDinhKemService.List">({{DuAnTapTinDinhKemService.List.length}}
                                                items)</span>
                                        </h5>
                                    </div>
                                    <div class="card-body bg-primary">
                                        <div class="table-outer">
                                            <div class="table-responsive">
                                                <table *ngIf="!NotificationService.IsMobile" mat-table matSort
                                                    #DuAnTapTinDinhKemSort="matSort" [dataSource]="DuAnTapTinDinhKemService.DataSource"
                                                    class="table table-striped m-0">
                                                    <ng-container matColumnDef="STT">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                                            STT
                                                        </th>
                                                        <td mat-cell *matCellDef="let element; index as i;" style="text-align: center;">
                                                            <div *ngIf="DuAnTapTinDinhKemPaginator">
                                                                {{DuAnTapTinDinhKemPaginator.pageSize *
                                                                DuAnTapTinDinhKemPaginator.pageIndex + i + 1}}
                                                            </div>
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="Name">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Tiêu đề
                                                        </th>
                                                        <td mat-cell *matCellDef="let element">
                                                            <input class="form-control" type="text" placeholder="Tiêu đề"
                                                                name="Name{{element.ID}}" [(ngModel)]="element.Name">
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="Display">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>URL (nếu có)
                                                        </th>
                                                        <td mat-cell *matCellDef="let element">
                                                            <input class="form-control" type="text" placeholder="URL (nếu có)"
                                                                name="Display{{element.ID}}" [(ngModel)]="element.Display">
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="Note">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ghi chú
                                                        </th>
                                                        <td mat-cell *matCellDef="let element">
                                                            <input class="form-control" type="text" placeholder="Ghi chú"
                                                                name="Note{{element.ID}}" [(ngModel)]="element.Note">
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="FileName">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Chọn tập tin
                                                        </th>
                                                        <td mat-cell *matCellDef="let element">
                                                            <input class="form-control" type="file" multiple
                                                                (change)="DuAnTapTinDinhKemChangeFile($event.target.files)">
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="Save">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                                        </th>
                                                        <td mat-cell *matCellDef="let element">
                                                            <a class="btn btn-info" (click)="DuAnTapTinDinhKemSave(element)"><i
                                                                    class="bi bi-sd-card"></i>
                                                            </a>&nbsp;&nbsp;&nbsp;
                                                            <a class="btn btn-danger" (click)="DuAnTapTinDinhKemDelete(element)"
                                                                *ngIf="element.ID>0"><i class="bi bi-trash"></i>
                                                            </a>&nbsp;&nbsp;&nbsp;
                                                            <a *ngIf="element.ID > 0 && element.FileName" class="btn btn-success"
                                                                title="Tải về" href="{{element.FileName}}" target="_blank"><i
                                                                    class="bi bi-cloud-download"></i>
                                                            </a>
                                                        </td>
                                                    </ng-container>
                                                    <tr mat-header-row *matHeaderRowDef="DuAnTapTinDinhKemService.DisplayColumns001">
                                                    </tr>
                                                    <tr mat-row *matRowDef="let row; columns: DuAnTapTinDinhKemService.DisplayColumns001;">
                                                    </tr>
                                                </table>
                                                <mat-paginator *ngIf="!NotificationService.IsMobile"
                                                    #DuAnTapTinDinhKemPaginator="matPaginator" [pageSizeOptions]="[10,20,50,100]"
                                                    [pageSize]="6" [showFirstLastButtons]></mat-paginator>
                                                <table *ngIf="NotificationService.IsMobile" mat-table matSort
                                                    #DuAnTapTinDinhKemSort="matSort" [dataSource]="DuAnTapTinDinhKemService.DataSource"
                                                    class="table table-striped m-0">
                                                    <ng-container matColumnDef="STT">
                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                                            Danh sách
                                                        </th>
                                                        <td mat-cell *matCellDef="let element; index as i;">
                                                            <div class="row gx-4">
                                                                <div class="col-lg-12 col-sm-12 col-12">
                                                                    <label class="form-label">Tiêu đề</label>
                                                                    <input class="form-control" type="text" placeholder="Tiêu đề"
                                                                        name="Name{{element.ID}}" [(ngModel)]="element.Name">
                                                                </div>
                                                                <div class="col-lg-12 col-sm-12 col-12">
                                                                    <label class="form-label">URL (nếu có)</label>
                                                                    <input class="form-control" type="text" placeholder="URL (nếu có)"
                                                                        name="Display{{element.ID}}" [(ngModel)]="element.Display">
                                                                </div>
                                                                <div class="col-lg-12 col-sm-12 col-12">
                                                                    <label class="form-label">Ghi chú</label>
                                                                    <input class="form-control" type="text" placeholder="Ghi chú"
                                                                        name="Note{{element.ID}}" [(ngModel)]="element.Note">
                                                                </div>
                                                                <div class="col-lg-12 col-sm-12 col-12">
                                                                    <label class="form-label">Chọn tập tin</label>
                                                                    <br />
                                                                    <input class="form-control" type="file" multiple
                                                                        (change)="DuAnTapTinDinhKemChangeFile($event.target.files)">
                                                                </div>
                                                                <div class="row gx-4">
                                                                    <div class="col-lg-4 col-sm-4 col-4">
                                                                        <a class="btn btn-info" style="width: 100%;"
                                                                            (click)="DuAnTapTinDinhKemSave(element)"><i
                                                                                class="bi bi-sd-card"></i>
                                                                        </a>
                                                                    </div>
                                                                    <div class="col-lg-4 col-sm-4 col-4">
                                                                        <a class="btn btn-danger" style="width: 100%;"
                                                                            (click)="DuAnTapTinDinhKemDelete(element)"
                                                                            *ngIf="element.ID>0"><i class="bi bi-trash"></i>
                                                                        </a>
                                                                    </div>
                                                                    <div class="col-lg-4 col-sm-4 col-4">
                                                                        <a *ngIf="element.ID > 0 && element.FileName"
                                                                            class="btn btn-success" title="Tải về" style="width: 100%;"
                                                                            href="{{element.FileName}}" target="_blank"><i
                                                                                class="bi bi-cloud-download"></i>
                                                                        </a>
                                                                    </div>
                                                                    <br />
                                                                    <br />
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </ng-container>
                                                    <tr mat-header-row *matHeaderRowDef="DuAnTapTinDinhKemService.DisplayColumnsMobile">
                                                    </tr>
                                                    <tr mat-row
                                                        *matRowDef="let row; columns: DuAnTapTinDinhKemService.DisplayColumnsMobile;">
                                                    </tr>
                                                </table>
                                                <mat-paginator *ngIf="NotificationService.IsMobile"
                                                    #DuAnTapTinDinhKemPaginator="matPaginator" [pageSizeOptions]="[10,20,50,100]"
                                                    [pageSize]="10000" [showFirstLastButtons]></mat-paginator>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<app-loading *ngIf="DuAnThuChiService.IsShowLoading"></app-loading>